Version 4
SHEET 1 2016 680
WIRE -96 -144 -192 -144
WIRE 16 -144 -16 -144
WIRE -192 -48 -192 -144
WIRE -96 -48 -192 -48
WIRE 16 -48 16 -144
WIRE 16 -48 -32 -48
WIRE -192 32 -192 -48
WIRE -192 32 -320 32
WIRE -144 32 -192 32
WIRE -112 32 -144 32
WIRE -320 48 -320 32
WIRE -192 64 -192 32
WIRE -112 64 -112 32
WIRE -80 64 -112 64
WIRE 16 80 16 -48
WIRE 16 80 -16 80
WIRE 80 80 16 80
WIRE 144 80 80 80
WIRE 240 80 208 80
WIRE 272 80 240 80
WIRE 352 80 272 80
WIRE -80 96 -112 96
WIRE 240 96 240 80
WIRE 464 96 416 96
WIRE 576 96 544 96
WIRE 688 96 576 96
WIRE 352 112 320 112
WIRE 800 112 752 112
WIRE 912 112 880 112
WIRE 960 112 912 112
WIRE 576 128 576 96
WIRE 688 128 656 128
WIRE -320 144 -320 128
WIRE -192 144 -192 128
WIRE -192 144 -320 144
WIRE -112 144 -112 96
WIRE 912 144 912 112
WIRE 320 160 320 112
WIRE -320 176 -320 144
WIRE 656 176 656 128
WIRE 240 208 240 176
WIRE 576 224 576 192
WIRE 912 240 912 208
WIRE -160 304 -160 288
WIRE -320 320 -320 288
WIRE -160 336 -160 304
WIRE -320 352 -320 320
WIRE -320 464 -320 416
WIRE -160 464 -160 432
FLAG -320 176 0
FLAG -160 464 0
FLAG -320 464 0
FLAG -112 144 vnp
FLAG -160 304 vnp
FLAG -320 320 vnn
FLAG -144 32 vnn
FLAG 240 208 0
FLAG 320 160 0
FLAG 576 224 0
FLAG 80 80 out1
FLAG 272 80 out2
FLAG 656 176 0
FLAG 912 240 0
FLAG 960 112 out
SYMBOL cap -208 64 R0
WINDOW 3 24 36 Left 2
SYMATTR Value {Ci}
SYMATTR InstName Ci1
SYMBOL cap -32 -64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cf1
SYMATTR Value 1p
SYMBOL Opamps\\opamp -48 16 R0
SYMATTR InstName U1
SYMATTR SpiceLine Aol={Aol_OPA}
SYMATTR SpiceLine2 GBW={GBW_OPA}
SYMBOL current -320 48 R0
WINDOW 0 33 17 Left 2
WINDOW 123 -27 191 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -33 167 Left 2
SYMATTR InstName Idet1
SYMATTR Value2 AC 1
SYMATTR Value PULSE(0 {Qdet/Ton} 20u {1e-4*Ton} {1e-4*Ton} {Ton})
SYMBOL vnoise -160 384 R0
WINDOW 39 0 0 Left 2
SYMATTR SpiceLine R={Rn}
SYMATTR InstName X1
SYMBOL inoise -320 384 R0
WINDOW 39 0 0 Left 2
SYMATTR SpiceLine R={Rn}
SYMATTR InstName X2
SYMBOL Opamps\\opamp 384 160 M180
SYMATTR InstName U2
SYMATTR SpiceLine Aol=1
SYMATTR SpiceLine2 GBW=10G
SYMBOL cap 208 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {Cs}
SYMBOL cap 592 192 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value {Cs}
SYMBOL res 224 80 R0
SYMATTR InstName R1
SYMATTR Value {Rs}
SYMBOL res 560 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {Rs}
SYMBOL Opamps\\opamp 720 176 M180
SYMATTR InstName U3
SYMATTR SpiceLine Aol=1
SYMATTR SpiceLine2 GBW=10G
SYMBOL cap 928 208 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C3
SYMATTR Value {Cs}
SYMBOL res 896 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {Rs}
SYMBOL res 0 -160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1G
TEXT -360 -344 Left 2 !.param Qdet=1p Ton=1n
TEXT -360 -184 Left 2 !.param Aol_OPA=1e5 GBW_OPA=100T
TEXT 272 -72 Left 2 !.tran 50u
TEXT 280 -344 Left 2 !.lib opamp.sub
TEXT -360 -304 Left 2 !.param Ci=99p
TEXT -360 -384 Left 2 ;Detector signal parameters.
TEXT 280 -376 Left 2 ;include the subcircuit for amplifier
TEXT 272 -104 Left 2 !;ac dec 10 1 1G
TEXT 272 -144 Left 2 ;Simulation and measurements
TEXT -352 -248 Left 2 ;Amplifier parameters
TEXT -352 -216 Left 2 ;open loop band width is set to 1e20 Hz
TEXT 272 -40 Left 2 !;noise V(out) Idet1 dec 100 1 1G
TEXT -112 448 Left 2 !.param Rn=10k
TEXT 352 144 Left 2 ;buffer
TEXT 280 -288 Left 2 ;parameters for the shaping time
TEXT 288 -224 Left 2 !.param Cs = 100p\n.param Rs={ts/Cs}
TEXT 248 368 Left 2 !.MEAS NOISE vno INTEG V(onoise)
TEXT 296 -256 Left 2 !.param ts=0.58u
TEXT 248 416 Left 2 !.meas TRAN Vm MAX V(out)
TEXT 248 448 Left 2 !.meas TRAN tm FIND V(out) WHEN V(out)=Vm
TEXT 248 480 Left 2 !.meas TRAN tw FIND V(out) WHEN V(out)=0.01*Vm fall=1
TEXT 688 160 Left 2 ;buffer
TEXT 840 -128 Left 2 ;Add Universal opa with supply -> Set DC points [Different schematic]
TEXT 840 -272 Left 2 ;Starting point: Test Circuit with ideal opamp (no pole)
TEXT 840 -240 Left 2 ;Sweep gain
TEXT 1240 -8 Left 2 !.step dec param Aol_OPA 10 100k 10
TEXT 1104 -240 Left 2 ;Q/Cf -> Q/(Cf+(Cf+Ci)/A -> Analyse/Calculate to have less than 0.1% of output
TEXT 840 -208 Left 2 ;Sweep Bandwidth for PREAMP -> No more than 0.1% peak loss at output
TEXT 840 -168 Left 2 ;Do the same job for the Buffers
TEXT 832 -88 Left 2 ;Replace by realistic opamps [provide list of candidates] to do the job
TEXT 832 -48 Left 2 ;Compare with ideal case
